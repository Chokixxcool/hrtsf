WIP python version of the whole processes
